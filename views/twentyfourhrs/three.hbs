<!DOCTYPE html>
<html>
	{{#> head title='24hrs v3 - Long Images' subtitle='Displaying the images of the last 24 hours of published articles - in full screen height format' }}
		<style type="text/css">
			html, body {
				margin: 0;
				padding: 0;
				overflow: hidden;
			}
			main {
			}
			a {
				display: inline-block;
			}
			img {
				display: inline-block;
				width: 100%;
				height: 100%;
			}
			header {
				display: none;
			}
		</style>
	{{/head}}
	<body>
		{{> header title='24hrs v3 - Long Images' subtitle='Displaying the images of the last 24 hours of published articles - in full screen height format'}}
		
		<main>
			<!-- results to go here -->
		</main>

		<script type="text/javascript" src="/static/js/main.js"></script>
		<script>
			function displayInDOM(json){
				var output = '';

				json.forEach(results => {
					let result = results.sapiObj.results[0].results
					result.forEach(article => {
						output += imageWrapper(article);
					});
				});

				document.getElementsByTagName('main')[0].innerHTML = output;
				calculateImageSizes();
			}

			function calculateImageSizes(){
				const containers 		= document.getElementsByTagName('a');
				const containersList	= Array.prototype.slice.call(containers);
				const width 			= window.innerWidth;
				const height 			= window.innerHeight;

				if(containersList.length > 0){
					let imgWidth = (window.innerWidth / containersList.length);
					let imgHeight = height;

					containersList.forEach(container => {
						container.style.height = imgHeight + 'px';
						container.style.width = imgWidth + 'px';
					});
				}
				
			}

			fetch('/24hrs/dataReq')
				.then(status)
				.then(json)
				.then(function(data) {
					console.log('Request succeeded with JSON response', data);
					displayInDOM(data);
				}).catch(function(error) {
					console.log('Request failed', error);
			});
		</script>
	</body>
</html>